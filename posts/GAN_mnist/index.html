<!DOCTYPE html><html lang="ko" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="[GAN] MNIST dataset을 이용한 손글씨 생성" /><meta property="og:locale" content="ko" /><meta name="description" content="GAN 아키텍쳐를 이용하여 MNIST 데이터셋을 학습시켜 새로운 손글씨 데이터를 생성하는 모델을 구현하였다. Dataset을 불러오고 전처리하는 코드, model를 정의하는 코드, 실제 학습을 진행하는 코드로 기능을 나누어 설계하였다. 현재 Pytorch를 공부하고 있는 입장이므로, 코드 한줄마다 자세한 설명을 담아 포스팅을 작성하였다." /><meta property="og:description" content="GAN 아키텍쳐를 이용하여 MNIST 데이터셋을 학습시켜 새로운 손글씨 데이터를 생성하는 모델을 구현하였다. Dataset을 불러오고 전처리하는 코드, model를 정의하는 코드, 실제 학습을 진행하는 코드로 기능을 나누어 설계하였다. 현재 Pytorch를 공부하고 있는 입장이므로, 코드 한줄마다 자세한 설명을 담아 포스팅을 작성하였다." /><link rel="canonical" href="https://isornorphism.github.io/posts/GAN_mnist/" /><meta property="og:url" content="https://isornorphism.github.io/posts/GAN_mnist/" /><meta property="og:site_name" content="Isomorphism!" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-02-23T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[GAN] MNIST dataset을 이용한 손글씨 생성" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-23T00:00:00+09:00","datePublished":"2022-02-23T00:00:00+09:00","description":"GAN 아키텍쳐를 이용하여 MNIST 데이터셋을 학습시켜 새로운 손글씨 데이터를 생성하는 모델을 구현하였다. Dataset을 불러오고 전처리하는 코드, model를 정의하는 코드, 실제 학습을 진행하는 코드로 기능을 나누어 설계하였다. 현재 Pytorch를 공부하고 있는 입장이므로, 코드 한줄마다 자세한 설명을 담아 포스팅을 작성하였다.","headline":"[GAN] MNIST dataset을 이용한 손글씨 생성","mainEntityOfPage":{"@type":"WebPage","@id":"https://isornorphism.github.io/posts/GAN_mnist/"},"url":"https://isornorphism.github.io/posts/GAN_mnist/"}</script><title>[GAN] MNIST dataset을 이용한 손글씨 생성 | Isomorphism!</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Isomorphism!"><meta name="application-name" content="Isomorphism!"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get MODE_ATTR() { return "data-mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } static get ID() { return "mode-toggle"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } let self = this; /* always follow the system prefers */ this.sysDarkPrefers.addEventListener("change", () => { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.notify(); }); } /* constructor() */ get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode === ModeToggle.DARK_MODE; } get isLightMode() { return this.mode === ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer)) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } setDark() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_ATTR, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_ATTR); sessionStorage.removeItem(ModeToggle.MODE_KEY); } /* Notify another plugins that the theme mode has changed */ notify() { window.postMessage({ direction: ModeToggle.ID, message: this.modeStatus }, "*"); } } /* ModeToggle */ const toggle = new ModeToggle(); function flipMode() { if (toggle.hasMode) { if (toggle.isSysDarkPrefer) { if (toggle.isLightMode) { toggle.clearMode(); } else { toggle.setLight(); } } else { if (toggle.isDarkMode) { toggle.clearMode(); } else { toggle.setDark(); } } } else { if (toggle.isSysDarkPrefer) { toggle.setLight(); } else { toggle.setDark(); } } toggle.notify(); } /* flipMode() */ </script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Isomorphism!</a></div><div class="site-subtitle" style="letter-spacing: -0.02em;">다채로운 vectorspace를 span할 수 있도록<br> orthogonal basis를 만드는 곳입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/CV/" class="nav-link"> <i class="fa-fw fas fa-file ml-xl-3 mr-xl-3 unloaded"></i> <span>CV</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <button class="mode-toggle btn" aria-label="Switch Mode"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/Isornorphism" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sgheong','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>[GAN] MNIST dataset을 이용한 손글씨 생성</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[GAN] MNIST dataset을 이용한 손글씨 생성</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/Isornorphism">Gwanhyeong Song</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2022-02-23 00:00:00 +0900" data-toggle="tooltip" data-placement="bottom" title="Wed, Feb 23, 2022, 12:00 AM +0900" >Feb 23, 2022</em> </span> <span> Updated <em class="timeago" date="2022-02-23" data-toggle="tooltip" data-placement="bottom" title="Wed, Feb 23, 2022, 12:00 AM +0000" >Feb 23, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2627 words"> <em>14 min</em> read</span></div></div></div><div class="post-content"><p>GAN 아키텍쳐를 이용하여 MNIST 데이터셋을 학습시켜 새로운 손글씨 데이터를 생성하는 모델을 구현하였다. Dataset을 불러오고 전처리하는 코드, model를 정의하는 코드, 실제 학습을 진행하는 코드로 기능을 나누어 설계하였다. 현재 Pytorch를 공부하고 있는 입장이므로, 코드 한줄마다 자세한 설명을 담아 포스팅을 작성하였다.</p><blockquote><p><em>관련 포스팅</em></p><ul><li><a href="https://isornorphism.github.io/posts/GAN_review/">[GAN] Generative Adversarial Nets 논문 리뷰</a></ul></blockquote><blockquote><p><em>다음 자료를 참고하여 작성하였습니다.</em></p><ul><li><a href="https://github.com/yunjey/pytorch-tutorial/blob/master/tutorials/03-advanced/generative_adversarial_network/main.py">pytorch-tutorial/main.py at master · yunjey/pytorch-tutorial</a><li><a href="https://www.kaggle.com/arpitfalcon/fake-handwritten-digits-using-gan">Fake Handwritten Digits using GAN</a><li><a href="https://iopscience.iop.org/article/10.1088/1742-6596/1827/1/012070/pdf">Generation of Handwritten Numbers Using Generative Adversarial Networks</a></ul></blockquote><p><br /></p><h2 id="0-util-함수-정의">0. Util 함수 정의 <a href="#0-util-함수-정의" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="필요한-패키지-import">필요한 패키지 import <a href="#필요한-패키지-import" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">torch</span>
<span class="kn">import</span> <span class="n">seaborn</span> <span class="k">as</span> <span class="n">sns</span>
<span class="kn">from</span> <span class="n">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="n">imageio</span>
<span class="kn">import</span> <span class="n">os</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">Seaborn</code> 패키지는 <code class="language-plaintext highlighter-rouge">Matplotlib</code>을 기반으로 다양한 테마와 챠트를 제공하는 시각화 패키지이다. <code class="language-plaintext highlighter-rouge">Imageio</code> 패키지는 gif 파일을 만들기 위해 사용하였다.</p><h3 id="이미지-출력-함수">이미지 출력 함수 <a href="#이미지-출력-함수" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">img</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>
    <span class="n">npimg</span> <span class="o">=</span> <span class="n">img</span><span class="p">.</span><span class="nf">detach</span><span class="p">().</span><span class="nf">cpu</span><span class="p">().</span><span class="nf">numpy</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">transpose</span><span class="p">(</span><span class="n">npimg</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">"Epoch {}"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">(</span><span class="n">block</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">pause</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span>
</pre></table></code></div></div><p>특정 epoch에서 generator에 의해 생성된 손글씨 이미지를 출력하기 위해 사용한다. <code class="language-plaintext highlighter-rouge">detach()</code>는 기존 tensor에서 gradient 전파가 안되는 tensor로 얕은 복사를 수행한다. 학습에 방해가 되지 않도록 2초간 이미지를 출력하고 팝업 창이 닫히도록 <code class="language-plaintext highlighter-rouge">plt.pause(2)</code>, <code class="language-plaintext highlighter-rouge">plt.close()</code>를 추가하였다.</p><h3 id="모델-저장">모델 저장 <a href="#모델-저장" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">save_checkpoint</span><span class="p">(</span><span class="n">model_list</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">model_state</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">model_list</span><span class="p">:</span>
        <span class="n">model_state</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">m</span><span class="p">.</span><span class="nf">state_dict</span><span class="p">())</span>
    <span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s">'model_state'</span> <span class="p">:</span> <span class="n">model_state</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">torch</span><span class="p">.</span><span class="nf">save</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre></table></code></div></div><p>학습이 끝까지 완료되었을 때, 혹은 학습 중간의 <code class="language-plaintext highlighter-rouge">model_list</code>에 있는 모든 모델의 파라미터 값을 저장한다.</p><h3 id="학습-그래프-출력-및-저장">학습 그래프 출력 및 저장 <a href="#학습-그래프-출력-및-저장" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">loss_graph</span><span class="p">(</span><span class="n">gen_loss_list</span><span class="p">,</span> <span class="n">dis_loss_list</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">sns</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>

    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">dis_loss_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="s">'dis'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">"Discriminator loss"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">"epoch"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">"loss"</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="nf">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">gen_loss_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="s">'gen'</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">"Generator loss"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">"epoch"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">"loss"</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
    
    
<span class="k">def</span> <span class="nf">pred_graph</span><span class="p">(</span><span class="n">real_pred_list</span><span class="p">,</span> <span class="n">fake_pred_list</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">sns</span><span class="p">.</span><span class="nf">set</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

    <span class="n">pred_list</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">vstack</span><span class="p">((</span><span class="n">real_pred_list</span><span class="p">,</span> <span class="n">fake_pred_list</span><span class="p">)).</span><span class="n">T</span>
    
    <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">pred_list</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">([</span><span class="s">'real'</span><span class="p">,</span> <span class="s">'fake'</span><span class="p">])</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">title</span><span class="p">(</span><span class="s">"Discriminator prediction"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">xlabel</span><span class="p">(</span><span class="s">"epoch"</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">ylabel</span><span class="p">(</span><span class="s">"loss"</span><span class="p">)</span>

    <span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</pre></table></code></div></div><p>Generator와 discriminator의 loss 값을 나타내는 그래프와, discriminator가 real data와 fake data를 예측하는 확률 값을 나타내는 그래프를 출력하고 저장한다.</p><h3 id="gif-파일-생성">Gif 파일 생성 <a href="#gif-파일-생성" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">generate_gif</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="n">path_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">path</span><span class="o">+</span><span class="sa">f</span><span class="s">"/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">"</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">os</span><span class="p">.</span><span class="nf">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)]</span>
    <span class="n">path_list</span><span class="p">.</span><span class="nf">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="nf">int</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">19</span><span class="p">:</span><span class="o">-</span><span class="mi">4</span><span class="p">]))</span>
    <span class="n">image_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">path_list</span><span class="p">]</span>
    <span class="n">imageio</span><span class="p">.</span><span class="nf">mimsave</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">image_list</span><span class="p">,</span> <span class="n">fps</span><span class="o">=</span><span class="mf">2.0</span><span class="p">)</span>
</pre></table></code></div></div><p>Epoch에 따라 GAN 모델이 생성한 손글씨 데이터의 변화를 나타낸 gif 파일을 생성한다.</p><p><br /></p><h2 id="1-dataset-불러오기">1. Dataset 불러오기 <a href="#1-dataset-불러오기" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="kn">from</span> <span class="n">torchvision</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="n">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">import</span> <span class="n">torchvision.transforms</span> <span class="k">as</span> <span class="n">transforms</span>
<span class="kn">import</span> <span class="n">util</span>

<span class="n">DATA_PATH</span> <span class="o">=</span> <span class="s">"./dataset_MNIST"</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>

<span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="p">.</span><span class="nc">Compose</span><span class="p">([</span><span class="n">transforms</span><span class="p">.</span><span class="nc">ToTensor</span><span class="p">(),</span>
                                <span class="n">transforms</span><span class="p">.</span><span class="nc">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,))])</span>

<span class="n">train_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">.</span><span class="nc">MNIST</span><span class="p">(</span><span class="n">root</span><span class="o">=</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">)</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="nc">DataLoader</span><span class="p">(</span><span class="n">dataset</span><span class="o">=</span><span class="n">train_data</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">drop_last</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">torchvision.transforms</code>는 이미지 데이터를 변형하는 메소드가 담겨있는 패키지로, <code class="language-plaintext highlighter-rouge">transforms.Compose()</code>를 이용해 변환을 합성하여 사용할 수 있다. 여기서는 이미지 데이터를 tensor 자료형으로 바꿔주는 <code class="language-plaintext highlighter-rouge">ToTensor()</code> 변환과 픽셀 데이터를 평균 $m=0.5$, 표준편차 $\sigma=0.5$로 바꿔주는 <code class="language-plaintext highlighter-rouge">Normalize()</code> 변환을 사용하였다. 원래 MNIST 데이터셋의 자료 범위는 $[0, 1]$이므로 $\frac{X-m}{\sigma}$에 의해 $[-1, 1]$ 범위로 변환된다.</p><p><code class="language-plaintext highlighter-rouge">datasets.MNIST()</code>는 MNIST 데이터셋를 불러오고 transform을 적용해준다. <code class="language-plaintext highlighter-rouge">download=True</code> parameter는 <code class="language-plaintext highlighter-rouge">root</code>에 데이터셋이 없으면 자동으로 다운로드 해주는 옵션이다.</p><p><code class="language-plaintext highlighter-rouge">torch.utils.data.DataLoader</code>는 dataset을 batch 크기에 맞춰 데이터를 묶고, shuffle하는 기능을 제공해주는 iterator이다. <code class="language-plaintext highlighter-rouge">drop_last=True</code>로 설정하여 batch 크기 데이터를 묶은 후 남은 나머지는 버려준다.</p><p><br /></p><h2 id="2-model-정의">2. Model 정의 <a href="#2-model-정의" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p>구현 세부 사항은 다음을 참고하였다.</p><p><img data-src="/assets/img/GAN_mnist/training details of GAN.jpg" alt="구현 세부 사항" width="90%" data-proofer-ignore> <em>출처: <a href="https://iopscience.iop.org/article/10.1088/1742-6596/1827/1/012070/pdf">Generation of Handwritten Numbers Using Generative Adversarial Networks</a></em></p><p>Hyper parameter에서 약간의 차이가 있다. 본 코드에서는 <code class="language-plaintext highlighter-rouge">batch_size=64</code>, <code class="language-plaintext highlighter-rouge">training epoch=200</code>를 사용하였다. Latent space의 dimension은 100으로 하였다. 또한 generator에서 Leaky_ReLU 대신 ReLU 함수를 적용하였다.</p><p>마지막 레이어에 활성 함수로 tanh 함수나 sigmoid 함수를 사용하는 이유는 출력 값의 특성 때문이다. Generator는 새로운 이미지 데이터를 생성하는 모델이므로, 출력 범위를 normalize한 입력 범위와 동일한 $[-1, 1]$로 맞추기 위해 tanh를 사용한다. Discriminator는 주어진 데이터가 real data일 확률을 출력하는 모델이므로, 출력 범위를 $[0, 1]$로 맞추기 위해 sigmoid 함수를 사용한다. ReLU 함수는 상한이 존재하지 않으므로 마지막 레이어에 활성 함수로 사용할 수 없다.</p><h3 id="generator-구현">Generator 구현 <a href="#generator-구현" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>

<span class="k">class</span> <span class="nc">Gen</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">image_size</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">(</span><span class="n">Gen</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="nf">__init__</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">ReLU</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">image_size</span><span class="p">))</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="nc">Tanh</span><span class="p">())</span>

        <span class="n">self</span><span class="p">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">model</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><h3 id="discriminator-구현">Discriminator 구현 <a href="#discriminator-구현" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="k">class</span> <span class="nc">Dis</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">image_size</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">):</span>
        <span class="nf">super</span><span class="p">(</span><span class="n">Dis</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="nf">__init__</span><span class="p">()</span>
        <span class="n">model</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">*</span><span class="mi">4</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">LeakyReLU</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="o">*</span><span class="mi">2</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">LeakyReLU</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">extend</span><span class="p">([</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">LeakyReLU</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
                      <span class="n">nn</span><span class="p">.</span><span class="nc">Dropout</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)])</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="nc">Linear</span><span class="p">(</span><span class="n">hidden_dim</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="n">model</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">nn</span><span class="p">.</span><span class="nc">Sigmoid</span><span class="p">())</span>

        <span class="n">self</span><span class="p">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">model</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">self</span><span class="p">.</span><span class="nf">model</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">torch.nn.Module</code>를 상속하여 구현한다. Latent dimension, hidden dimension, image size를 parameter로 받는다.</p><p>레이어 구조를 출력해보면 다음과 같다.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">generator</span> <span class="o">=</span> <span class="nc">Gen</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">256</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
    <span class="n">discriminator</span> <span class="o">=</span> <span class="nc">Dis</span><span class="p">(</span><span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">generator</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">discriminator</span><span class="p">)</span>
</pre></table></code></div></div><div class="language-console highlighter-rouge"><div class="code-header"> <span data-label-text="Console"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
</pre><td class="rouge-code"><pre><span class="go">Gen(
  (model): Sequential(
    (0): Linear(in_features=100, out_features=256, bias=True)
    (1): ReLU(inplace=True)
    (2): Linear(in_features=256, out_features=512, bias=True)
    (3): ReLU(inplace=True)
    (4): Linear(in_features=512, out_features=1024, bias=True)
    (5): ReLU(inplace=True)
    (6): Linear(in_features=1024, out_features=784, bias=True)
    (7): Tanh()
  )
)
Dis(
  (model): Sequential(
    (0): Linear(in_features=784, out_features=1024, bias=True)
    (1): LeakyReLU(negative_slope=0.2)
    (2): Dropout(p=0.3, inplace=True)
    (3): Linear(in_features=1024, out_features=512, bias=True)
    (4): LeakyReLU(negative_slope=0.2)
    (5): Dropout(p=0.3, inplace=True)
    (6): Linear(in_features=512, out_features=256, bias=True)
    (7): LeakyReLU(negative_slope=0.2)
    (8): Dropout(p=0.3, inplace=True)
    (9): Linear(in_features=256, out_features=1, bias=True)
    (10): Sigmoid()
  )
)
</span></pre></table></code></div></div><p><br /></p><h2 id="3-학습">3. 학습 <a href="#3-학습" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><h3 id="필요한-패키지-import-및-메모리-초기화">필요한 패키지 import 및 메모리 초기화 <a href="#필요한-패키지-import-및-메모리-초기화" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="kn">import</span> <span class="n">torch</span>
<span class="kn">import</span> <span class="n">torch.nn</span> <span class="k">as</span> <span class="n">nn</span>
<span class="kn">from</span> <span class="n">torchvision.utils</span> <span class="kn">import</span> <span class="n">make_grid</span>
<span class="kn">import</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">util</span>
<span class="kn">import</span> <span class="n">gc</span>

<span class="n">gc</span><span class="p">.</span><span class="nf">collect</span><span class="p">()</span>
<span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">is_available</span><span class="p">():</span>
    <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">empty_cache</span><span class="p">()</span>
</pre></table></code></div></div><h3 id="hyper-parameter-정의">Hyper parameter 정의 <a href="#hyper-parameter-정의" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="n">RESULT_DIR</span> <span class="o">=</span> <span class="s">"./result"</span>
<span class="n">DEVICE</span> <span class="o">=</span> <span class="s">"cuda"</span> <span class="k">if</span> <span class="n">torch</span><span class="p">.</span><span class="n">cuda</span><span class="p">.</span><span class="nf">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s">"cpu"</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">n_epoches</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">latent_dim</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">hidden_dim</span> <span class="o">=</span> <span class="mi">256</span>
<span class="n">image_size</span> <span class="o">=</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="mf">2e-4</span>
<span class="n">fixed_z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">ones</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">gen_loss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">dis_loss_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">real_pred_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">fake_pred_list</span> <span class="o">=</span> <span class="p">[]</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">fixed_z</code>는 latent space에서의 고정된 데이터에 대하여 학습이 진행됨에 따라 generator가 생성하는 이미지의 변화를 관찰하기 위해 사용하는 값이다.</p><h3 id="model-optimizer-loss-function-dataloader-선언">Model, optimizer, loss function, dataloader 선언 <a href="#model-optimizer-loss-function-dataloader-선언" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="n">gen</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nc">Gen</span><span class="p">(</span><span class="n">latent_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">image_size</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">dis</span> <span class="o">=</span> <span class="n">model</span><span class="p">.</span><span class="nc">Dis</span><span class="p">(</span><span class="n">image_size</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
<span class="n">op_gen</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="nc">Adam</span><span class="p">(</span><span class="n">gen</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">))</span>
<span class="n">op_dis</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">optim</span><span class="p">.</span><span class="nc">Adam</span><span class="p">(</span><span class="n">dis</span><span class="p">.</span><span class="nf">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">learning_rate</span><span class="p">,</span> <span class="n">betas</span><span class="o">=</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.999</span><span class="p">))</span>
<span class="n">loss_func</span> <span class="o">=</span> <span class="n">nn</span><span class="p">.</span><span class="nc">BCELoss</span><span class="p">()</span>
<span class="n">train_loader</span> <span class="o">=</span> <span class="n">dataset</span><span class="p">.</span><span class="n">train_loader</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">nn.BCELoss()</code>는 $l_n = -\left[y_n \cdot \log x_n + (1 - y_n) \cdot \log (1 - x_n)\right]$로 정의되는 loss function이다.</p><h3 id="학습-진행">학습 진행 <a href="#학습-진행" class="anchor"><i class="fas fa-hashtag"></i></a></h3></h3><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n_epoches</span><span class="p">):</span>
    <span class="n">gen</span><span class="p">.</span><span class="nf">train</span><span class="p">()</span>
    <span class="n">dis</span><span class="p">.</span><span class="nf">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">images</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">train_loader</span><span class="p">:</span>
        <span class="n">images</span> <span class="o">=</span> <span class="n">images</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

        <span class="c1">#generator loss
</span>        <span class="n">gen</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
        <span class="n">fake_images</span> <span class="o">=</span> <span class="nf">gen</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">fake_pred</span> <span class="o">=</span> <span class="nf">dis</span><span class="p">(</span><span class="n">fake_images</span><span class="p">)</span>

        <span class="n">gen_loss</span> <span class="o">=</span> <span class="nf">loss_func</span><span class="p">(</span><span class="n">fake_pred</span><span class="p">,</span> <span class="n">ones</span><span class="p">)</span>
        <span class="n">gen_loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
        <span class="n">op_gen</span><span class="p">.</span><span class="nf">step</span><span class="p">()</span>

        <span class="c1">#discriminator loss
</span>        <span class="n">dis</span><span class="p">.</span><span class="nf">zero_grad</span><span class="p">()</span>
        <span class="n">real_pred</span> <span class="o">=</span> <span class="nf">dis</span><span class="p">(</span><span class="n">images</span><span class="p">)</span>
        <span class="n">dis_loss_real</span> <span class="o">=</span> <span class="nf">loss_func</span><span class="p">(</span><span class="n">real_pred</span><span class="p">,</span> <span class="n">ones</span><span class="p">)</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="nf">randn</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latent_dim</span><span class="p">).</span><span class="nf">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
        <span class="n">fake_images</span> <span class="o">=</span> <span class="nf">gen</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
        <span class="n">fake_pred</span> <span class="o">=</span> <span class="nf">dis</span><span class="p">(</span><span class="n">fake_images</span><span class="p">)</span>
        <span class="n">dis_loss_fake</span> <span class="o">=</span> <span class="nf">loss_func</span><span class="p">(</span><span class="n">fake_pred</span><span class="p">,</span> <span class="n">zeros</span><span class="p">)</span>

        <span class="n">dis_loss</span> <span class="o">=</span> <span class="n">dis_loss_real</span> <span class="o">+</span> <span class="n">dis_loss_fake</span>
        <span class="n">dis_loss</span><span class="p">.</span><span class="nf">backward</span><span class="p">()</span>
        <span class="n">op_dis</span><span class="p">.</span><span class="nf">step</span><span class="p">()</span>
        
    
    <span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="n">autograd</span><span class="p">.</span><span class="nf">no_grad</span><span class="p">():</span>
        <span class="n">real_pred_mean</span> <span class="o">=</span> <span class="n">real_pred</span><span class="p">.</span><span class="nf">mean</span><span class="p">()</span>
        <span class="n">fake_pred_mean</span> <span class="o">=</span> <span class="n">fake_pred</span><span class="p">.</span><span class="nf">mean</span><span class="p">()</span>
            
        <span class="n">real_pred_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">real_pred_mean</span><span class="p">.</span><span class="nf">item</span><span class="p">())</span>
        <span class="n">fake_pred_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">fake_pred_mean</span><span class="p">.</span><span class="nf">item</span><span class="p">())</span>
        <span class="n">gen_loss_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">gen_loss</span><span class="p">.</span><span class="nf">item</span><span class="p">())</span>
        <span class="n">dis_loss_list</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">dis_loss</span><span class="p">.</span><span class="nf">item</span><span class="p">())</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[Epoch </span><span class="si">{</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s">/</span><span class="si">{</span><span class="n">n_epoches</span><span class="si">}</span><span class="s">]'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[Generator loss: </span><span class="si">{</span><span class="n">gen_loss</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span><span class="si">}</span><span class="s"> | Discriminator loss: </span><span class="si">{</span><span class="n">dis_loss</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span><span class="si">}</span><span class="s">]'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="s">'[real prediction: </span><span class="si">{</span><span class="n">real_pred_mean</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span><span class="si">}</span><span class="s"> | fake_prediction: </span><span class="si">{</span><span class="n">fake_pred_mean</span><span class="p">.</span><span class="nf">item</span><span class="p">()</span><span class="si">}</span><span class="s">]'</span><span class="p">)</span>
        <span class="nf">print</span><span class="p">()</span>

        <span class="nf">if </span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">20</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">epoch</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">gen</span><span class="p">.</span><span class="nf">eval</span><span class="p">()</span>
            <span class="n">sample_images</span> <span class="o">=</span> <span class="nf">gen</span><span class="p">(</span><span class="n">fixed_z</span><span class="p">)</span>
            <span class="n">sample_images</span> <span class="o">=</span> <span class="n">sample_images</span><span class="p">.</span><span class="nf">reshape</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
            <span class="n">util</span><span class="p">.</span><span class="nf">imshow</span><span class="p">(</span><span class="nf">make_grid</span><span class="p">(</span><span class="n">sample_images</span><span class="p">),</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">RESULT_DIR</span><span class="o">+</span><span class="s">"/gif/epoch {}.jpg"</span><span class="p">.</span><span class="nf">format</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>

<span class="n">util</span><span class="p">.</span><span class="nf">save_checkpoint</span><span class="p">([</span><span class="n">gen</span><span class="p">,</span> <span class="n">dis</span><span class="p">],</span> <span class="n">RESULT_DIR</span><span class="o">+</span><span class="s">"/MNIST_gan.pt"</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="nf">loss_graph</span><span class="p">(</span><span class="n">gen_loss_list</span><span class="p">,</span> <span class="n">dis_loss_list</span><span class="p">,</span> <span class="n">RESULT_DIR</span><span class="o">+</span><span class="s">"/loss_graph_gan.jpg"</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="nf">pred_graph</span><span class="p">(</span><span class="n">real_pred_list</span><span class="p">,</span> <span class="n">fake_pred_list</span><span class="p">,</span> <span class="n">RESULT_DIR</span><span class="o">+</span><span class="s">"/prediction_gan.jpg"</span><span class="p">)</span>
<span class="n">util</span><span class="p">.</span><span class="nf">generate_gif</span><span class="p">(</span><span class="n">RESULT_DIR</span><span class="o">+</span><span class="s">"/gif"</span><span class="p">,</span> <span class="n">RESULT_DIR</span><span class="o">+</span><span class="s">"/gif_gan.gif"</span><span class="p">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">gen.train()</code>, <code class="language-plaintext highlighter-rouge">gen.eval()</code>는 각각 모델을 train 모드와 evaluation 모드로 변경한다. Evaluation 모드에서는 dropout, batch normalization와 같이 학습할 때만 적용해야하는 레이어 기능을 비활성화 시킨다. <code class="language-plaintext highlighter-rouge">gen.zero_grad()</code>는 역전파 과정을 실행하기 전 각 parameter의 gradient를 0으로 초기화한다. 모델의 가중치를 갱신하기 전에 적용한다.</p><p>Channel 수가 1인 28 * 28 사이즈의 이미지 데이터를 1차원 데이터로 flatten하여 모델에 대입해주기 위해 <code class="language-plaintext highlighter-rouge">reshape(batch_size, -1)</code>를 적용해준다.</p><p>Generator는 원래 목적 함수 $\log (1-D(G(z)))$를 최소화하여야 한다. 그러나 <a href="https://arxiv.org/pdf/1406.2661.pdf">원 논문</a>의 3. Adversarial nets 3번째 문단을 보면, $\log D(G(z))$를 최대화하도록 학습하는 편이 더 좋은 결과를 낳는다고 설명한다.</p><blockquote><p>Rather than training $G$ to minimize $\log (1-D(G(z)))$ we can train $G$ to maximize $\log D(G(z))$. This objective function results in the same fixed point of the dynamics of $G$ and $D$ but provides much stronger gradients early in learning.</p></blockquote><p>따라서 $BCELoss(D(G(z)), 1) = - \log D(G(z))$를 최소화하도록 generator를 학습한다.</p><p>마찬가지로 Discriminator는 목적 함수 $\log D(x) + \log (1-D(G(z)))$를 최대화하여야 하므로 $BCELoss(D(x), 1) + BCELoss(D(G(z)), 0)$를 최소화하도록 학습한다.</p><p>매 epoch마다 generator와 discriminator의 loss를 출력하고 리스트에 저장한다. 또한 real data와 fake data에 대한 discriminator의 예측을 batch 단위로 평균내어 출력하고 리스트에 저장한다. 20 epoch마다 고정된 latent data를 generator에 입력하여 출력되는 새로운 손글씨 데이터를 저장한다.</p><p>학습을 완료한 후 모델과 학습 그래프를 저장하고, gif 이미지를 생성한다.</p><p><br /></p><h2 id="4-결과">4. 결과 <a href="#4-결과" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><p><img data-src="/assets/img/GAN_mnist/loss_graph_gan.jpg" alt="loss graph" width="90%" data-proofer-ignore> <em>Loss 값이 감소하는 것이 잘 관찰되지 않는다.</em></p><p><br /></p><p><img data-src="/assets/img/GAN_mnist/prediction_gan.jpg" alt="prediction graph" width="90%" data-proofer-ignore> <em>이론적으로는 prediction 값이 0.5로 수렴해야하나, 이 역시 잘 관찰되지 않는다.</em></p><p><br /></p><p><img data-src="/assets/img/GAN_mnist/gif_gan.gif" alt="gif_gan" width="90%" data-proofer-ignore> <em>20 epoch 별로 나타낸 새로운 손글씨 데이터</em></p><p><br /></p><p><img data-src="/assets/img/GAN_mnist/gif_gan_early.gif" alt="gif_gan_early" width="90%" data-proofer-ignore> <em>초반 학습에서 새로운 손글씨 데이터 변화</em></p><p>전체적으로 수렴이 잘 진행되지 않는다. Loss 값이나 prediction 값이 전 epoch에 걸쳐 잘 변하지 않고, 학습 종료 후 생성된 데이터와 초반부 학습 때 생성된 데이터가 별반 달라보이지 않는다. 이러한 한계점을 극복하여 성능을 향상시키고자 다양한 GAN 모델이 개발되었다. 그 중에서, 다음 포스팅은 이미지 데이터 학습에 유리한 DCGAN과 CGAN에 대해 정리해볼 것이다.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/ai-ml-dl/'>AI/ML/DL</a>, <a href='/categories/gan/'>GAN</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/gan/" class="post-tag no-text-decoration" >gan</a> <a href="/tags/generative-model/" class="post-tag no-text-decoration" >generative model</a> <a href="/tags/generator/" class="post-tag no-text-decoration" >generator</a> <a href="/tags/discriminator/" class="post-tag no-text-decoration" >discriminator</a> <a href="/tags/mnist/" class="post-tag no-text-decoration" >mnist</a> <a href="/tags/pytorch/" class="post-tag no-text-decoration" >pytorch</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[GAN] MNIST dataset을 이용한 손글씨 생성 - Isomorphism!&url=https://isornorphism.github.io/posts/GAN_mnist/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[GAN] MNIST dataset을 이용한 손글씨 생성 - Isomorphism!&u=https://isornorphism.github.io/posts/GAN_mnist/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://isornorphism.github.io/posts/GAN_mnist/&text=[GAN] MNIST dataset을 이용한 손글씨 생성 - Isomorphism!" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/IR_light_2/">[IR light] 전등 리모컨 제작기 - 2</a><li><a href="/posts/IR_light_3/">[IR light] 전등 리모컨 제작기 - 3</a><li><a href="/posts/IR_light_1/">[IR light] 전등 리모컨 제작기 - 1</a><li><a href="/posts/3D_scanner_4/">[3D scanner] 3D scanner 제작기 - 4</a><li><a href="/posts/3D_scanner_3/">[3D scanner] 3D scanner 제작기 - 3</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/3d-scanner/">3D scanner</a> <a class="post-tag" href="/tags/ir-light/">IR light</a> <a class="post-tag" href="/tags/solidworks/">Solidworks</a> <a class="post-tag" href="/tags/discriminator/">discriminator</a> <a class="post-tag" href="/tags/exponential/">exponential</a> <a class="post-tag" href="/tags/gan/">gan</a> <a class="post-tag" href="/tags/generative-model/">generative model</a> <a class="post-tag" href="/tags/generator/">generator</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/levenberg/">Levenberg</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/GAN_review/"><div class="card-body"> <em class="timeago small" date="2022-02-14 00:00:00 +0900" >Feb 14, 2022</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[GAN] Generative Adversarial Nets 논문 리뷰</h3><div class="text-muted small"><p> GAN은 Generative Adversarial Nets에서 처음 소개된 아키텍쳐이다. GAN은 딥러닝 기반 생성 모델에 매우 큰 영향을 미쳤으며, 오늘날까지 GAN을 기반으로 한 다양한 파생 모델이 등장하고 있다. 이번 포스팅에서는 GAN에 대하여 간단히 정리해 보았다. 본 포스팅은 다음 자료를 참고하였습니다. GAN: Gene...</p></div></div></a></div><div class="card"> <a href="/posts/IR_light_3/"><div class="card-body"> <em class="timeago small" date="2023-04-19 00:00:00 +0900" >Apr 19</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[IR light] 전등 리모컨 제작기 - 3</h3><div class="text-muted small"><p> 관련 포스팅 [IR light] 전등 리모컨 제작기 - 1 [IR light] 전등 리모컨 제작기 - 2 3. PC 프로그램 제작 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 ...</p></div></div></a></div><div class="card"> <a href="/posts/IR_light_2/"><div class="card-body"> <em class="timeago small" date="2023-04-19 00:00:00 +0900" >Apr 19</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[IR light] 전등 리모컨 제작기 - 2</h3><div class="text-muted small"><p> 관련 포스팅 [IR light] 전등 리모컨 제작기 - 1 2. IR 송신 모듈 제작 2.1 IR 송신 회로 IR sender circuit diagram IR sender circuit schematic IR sender circuit 아두이노 DC 핀의 출력 전류는 최대 40mA 정도로 알려져 있습니다....</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/GAN_review/" class="btn btn-outline-primary" prompt="Older"><p>[GAN] Generative Adversarial Nets 논문 리뷰</p></a> <a href="/posts/LOAM_review/" class="btn btn-outline-primary" prompt="Newer"><p>[LOAM] LOAM: Lidar Odometry and Mapping in Real-time 논문 리뷰</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://github.com/Isornorphism">Gwanhyeong Song</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/3d-scanner/">3D scanner</a> <a class="post-tag" href="/tags/ir-light/">IR light</a> <a class="post-tag" href="/tags/solidworks/">Solidworks</a> <a class="post-tag" href="/tags/discriminator/">discriminator</a> <a class="post-tag" href="/tags/exponential/">exponential</a> <a class="post-tag" href="/tags/gan/">gan</a> <a class="post-tag" href="/tags/generative-model/">generative model</a> <a class="post-tag" href="/tags/generator/">generator</a> <a class="post-tag" href="/tags/hardware/">hardware</a> <a class="post-tag" href="/tags/levenberg/">Levenberg</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script>
